(defwidget wbar []
    (centerbox :orientation "h"
        (leftstuff :hexpand true)
        (box :hexpand true )
        (rightstuff :hexpand true)
    )
)

(defwidget leftstuff []
    (box :class "test"
         :halign "start"
         :space-evenly false
         :spacing 8
        (label :text "  ")
        (label :class "workspace" :text workspace)
        (label :class "bmode" :text binding-mode)
        (button :class "todo" :onclick "kitty --detach nvim ~/.todo" (label :text todos))
        (label :text bat_time_remaining)
        (box :hexpand true (label :text music-playing))
    )
)

(defwidget rightstuff []
    (box :class "time"
         :halign "end"
         :orientation "h"
         :space-evenly false
         :spacing 0
         (button :class "wifi" (label :text wifi))
         (label :class "temp" :text temp)
         (button :class "load" (label :text load))
         (label :class "mem" :text mem)
         (button :class "volume" :onclick "amixer set Master 1+ toggle" (label :text volume))
         (button :class "brightness" (label :text brightness))
         (label :class "battery" :text battery)
         (button :class "time" (label :text time))
    )
)

(defpoll time :interval "15s" "date '+üìÖ:%d%b,%a  üïê:%H:%M:%S'")
(defpoll volume :interval "1s" "./get_volume.sh")
(defpoll music-playing :interval "2s" "./get_music.sh")
(defpoll binding-mode :interval "1s" "./get_binding_mode.sh")
(defpoll brightness :interval "2s" "./get_brightness.sh")
(defpoll load :interval "5s" "./get_avg_load_1min.sh")
(defpoll mem :interval "5s" "./get_mem_used.sh")
(defpoll temp :interval "5s" "./get_temp.sh")
(defpoll battery :interval "15s" "./get_battery.sh")
(defpoll bat_time_remaining :interval "15s" "./get_bat_time.sh")
(defpoll workspace :interval "0.5s" "./get_workspace.sh")
(defpoll wifi :interval "5s" "./get_wifi.sh")
(defpoll todos :interval "10s" "./get_no_of_todos.sh")

(defwindow bar
  :monitor 0
  :windowtype "dock"
  :geometry (geometry
    :anchor "top center"
    :x "0%"
    :y "0%"
    :width "100%"
    :height "0px")
  (wbar)
)
